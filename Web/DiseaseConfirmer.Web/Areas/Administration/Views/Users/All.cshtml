@model DiseaseConfirmer.Web.ViewModels.Administration.Users.AllUsersViewModel

@using DiseaseConfirmer.Common
@using Microsoft.AspNetCore.Identity
@using DiseaseConfirmer.Data.Models

@inject UserManager<ApplicationUser> UserManager

@{
    this.ViewData["Title"] = "Admin dashboard";
}

<div class="row">
    <div class="col-sm">
        <h3 class="text-center">Users</h3>
        <h4 class="text-center">Number of Users: @Model.Users.Count()</h4>
        <ul class="list-group">
            <li class="list-group-item d-flex align-items-center">
                @{ApplicationUser admin = await this.UserManager.GetUserAsync(this.User);}
                <span style="font-size: large"><strong>(ME) @admin.UserName</strong></span>
                <span title="Admin" class="m-2"><i class="fas fa-user-cog"></i> </span>
            </li>
            @foreach (var user in Model.Users)
            {
                ApplicationUser currentUser = await this.UserManager.FindByIdAsync(user.Id);
                IList<string> currentUserRoles = await this.UserManager.GetRolesAsync(currentUser);
                @if (this.User.Identity.Name != currentUser.UserName)
                {
                    <li class="list-group-item d-flex align-items-center">
                        @user.UserName
                        @if (currentUserRoles.Contains(GlobalConstants.DoctorRoleName))
                        {
                        <a class="text-white btn btn-secondary m-2" href="/Administration/Roles/RemoveUserFromRole?userId=@user.Id&roleName=@GlobalConstants.DoctorRoleName">
                            Remove Doctor
                        </a>
                        <span title="Doctor" class="m-2"><i class="fas fa-user-md"></i></span>
                        }
                        else
                        {
                        <a class="text-white btn btn-primary m-2" href="/Administration/Roles/AddUserToRole?userId=@user.Id&roleName=@GlobalConstants.DoctorRoleName">
                            Make Doctor
                        </a>
                        }
                    </li>
                }

            }
        </ul>
    </div>
</div>


